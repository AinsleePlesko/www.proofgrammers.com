---
title: "DetectNoMainFunction Decision Problem"
description: "Explore the detection of main functions"
date: "2025-09-08"
date-format: long
author: Benedek Kaibas, Abishek Dhakal, Will Bennett
execute:
  echo: true
format:
  live-revealjs:
    completion: true
    theme: default
    css: ../../../css/styles.css
    history: false
    scrollable: true
    transition: slide
    highlight-style: github
    footer: "Proofgrammers"
---

## What is the main function in Python?

The main function in Python is declared, like this: `def main(some parameter):`

The `if __name__ == "__main__"` guard checks whether a Python file has a main function.

Direct run: then `__name__` is set to `"__main__"` -> block inside will be run.

Imported Python File e.g.: `import my_script` then `__name__` is set to `my_script` ->
no need for `main` function.

## How does the main function look like in other languages?

Let's see some other programming languages:

- C++:

```
int main(int argc, const* argv[]) {// call of the function} // parameters can be missed
```

## Do we always need a main function in Python?

In **Python**, you donâ€™t always need a `main()` function like in C, C++, or Java.

- Python runs files **top to bottom**.
- Any **top-level** code runs immediately when the script is executed.

#### Example: without `main()`

```{pyodide}
#| autorun: true
print("Hello, World!")

# This code runs immediately when the script is executed
```

## Our tool to detect main function in Python programs

```{pyodide}
#| autorun: false

import ast

class ASTAnalyzer:
    def create_ast(self):
        """Creating an Abstract Syntax Tree."""
        try:
            with open("main.py", "r", encoding='utf-8') as fn:
                read_fn = fn.read()
                code = ast.parse(read_fn)
            return code
        except FileNotFoundError:
            print("Error: 'main.py' not found.")
            return None

    def walk_tree(self):
        """Walking through the created AST."""
        code = self.create_ast()
        if code is None:
            return None
        functions = []
        for node in ast.walk(code):
            if isinstance(node, ast.FunctionDef):
                functions.append(node.name)
                return functions

    def find_main(self):
        """Find main function in nodes created from the AST."""
        ast_function = self.walk_tree()
        if not ast_function:
            return
        main_name = "'main'"

        for name in ast_function:
            if name == "main":
                print(f"Main function found: {name}")
            else:
                print("The function you have entered as an input contains no main function.")


if __name__ == "__main__":
    analyzer = ASTAnalyzer()
    analyzer.walk_tree()
    analyzer.find_main()
```

## How does our DetectMainFunction tool work?

```{pyodide}
#| autorun: true

import ast

class ASTAnalyzer:
    def create_ast(self):
        """Create an AST from an in-memory Python snippet."""
        code_with_main = """\
def main(word: str) -> str:
    text = "gators"
    if word in text:
        return "True"
    else:
        return "False"

if __name__ == "__main__":
    print(main("gators"))
"""
        return ast.parse(code_with_main)

    def walk_tree(self):
        """Return a list of function names in the AST."""
        tree = self.create_ast()
        functions = []
        for node in ast.walk(tree):
            if isinstance(node, ast.FunctionDef):
                functions.append(node.name)
        return functions

    def find_main(self):
        """Print whether a 'main' function exists."""
        fn_names = self.walk_tree()
        if "main" in fn_names:
            print("Main function found: main")
        else:
            print("The function you have entered as an input contains no main function.")

if __name__ == "__main__":
    analyzer = ASTAnalyzer()
    analyzer.find_main()
```

## Cases where we cannot detect main function

placeholde

